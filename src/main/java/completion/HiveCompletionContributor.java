package completion;

import com.intellij.codeInsight.completion.CompletionContributor;
import com.intellij.codeInsight.completion.CompletionType;
import com.intellij.patterns.PlatformPatterns;
import plugin.HiveFileType;

import java.util.Arrays;

/**
 * @author nobody
 */
public class HiveCompletionContributor extends CompletionContributor {

    public static final String[] KEY_WORDS = {
            "SEMICOLON",
            "LEFT_PAREN",
            "RIGHT_PAREN",
            "COMMA",
            "DOT",
            "LEFT_BRACKET",
            "RIGHT_BRACKET",
            "ADD",
            "AFTER",
            "ALL",
            "ALTER",
            "ANALYZE",
            "AND",
            "ANTI",
            "ANY",
            "ANY_VALUE",
            "ARCHIVE",
            "ARRAY",
            "AS",
            "ASC",
            "AT",
            "AUTHORIZATION",
            "BETWEEN",
            "BOTH",
            "BUCKET",
            "BUCKETS",
            "BY",
            "CACHE",
            "CASCADE",
            "CASE",
            "CAST",
            "CATALOG",
            "CATALOGS",
            "CHANGE",
            "CHECK",
            "CLEAR",
            "CLUSTER",
            "CLUSTERED",
            "CODEGEN",
            "COLLATE",
            "COLLECTION",
            "COLUMN",
            "COLUMNS",
            "COMMENT",
            "COMMIT",
            "COMPACT",
            "COMPACTIONS",
            "COMPUTE",
            "CONCATENATE",
            "CONSTRAINT",
            "COST",
            "CREATE",
            "CROSS",
            "CUBE",
            "CURRENT",
            "CURRENT_DATE",
            "CURRENT_TIME",
            "CURRENT_TIMESTAMP",
            "CURRENT_USER",
            "DAY",
            "DAYOFYEAR",
            "DATA",
            "DATABASE",
            "DATABASES",
            "DATEADD",
            "DATEDIFF",
            "DBPROPERTIES",
            "DEFAULT",
            "DEFINED",
            "DELETE",
            "DELIMITED",
            "DESC",
            "DESCRIBE",
            "DFS",
            "DIRECTORIES",
            "DIRECTORY",
            "DISTINCT",
            "DISTRIBUTE",
            "DIV",
            "DROP",
            "ELSE",
            "END",
            "ESCAPE",
            "ESCAPED",
            "EXCEPT",
            "EXCHANGE",
            "EXISTS",
            "EXPLAIN",
            "EXPORT",
            "EXTENDED",
            "EXTERNAL",
            "EXTRACT",
            "FALSE",
            "FETCH",
            "FIELDS",
            "FILTER",
            "FILEFORMAT",
            "FIRST",
            "FOLLOWING",
            "FOR",
            "FOREIGN",
            "FORMAT",
            "FORMATTED",
            "FROM",
            "FULL",
            "FUNCTION",
            "FUNCTIONS",
            "GLOBAL",
            "GRANT",
            "GROUP",
            "GROUPING",
            "HAVING",
            "HOUR",
            "IF",
            "IGNORE",
            "IMPORT",
            "IN",
            "INDEX",
            "INDEXES",
            "INNER",
            "INPATH",
            "INPUTFORMAT",
            "INSERT",
            "INTERSECT",
            "INTERVAL",
            "INTO",
            "IS",
            "ITEMS",
            "JOIN",
            "KEYS",
            "LAST",
            "LATERAL",
            "LAZY",
            "LEADING",
            "LEFT",
            "LIKE",
            "ILIKE",
            "LIMIT",
            "LINES",
            "LIST",
            "LOAD",
            "LOCAL",
            "LOCATION",
            "LOCK",
            "LOCKS",
            "LOGICAL",
            "MACRO",
            "MAP",
            "MATCHED",
            "MERGE",
            "MICROSECOND",
            "MILLISECOND",
            "MINUTE",
            "MONTH",
            "MSCK",
            "NAMESPACE",
            "NAMESPACES",
            "NATURAL",
            "NO",
            "NOT",
            "NULL",
            "NULLS",
            "OF",
            "OFFSET",
            "ON",
            "ONLY",
            "OPTION",
            "OPTIONS",
            "OR",
            "ORDER",
            "OUT",
            "OUTER",
            "OUTPUTFORMAT",
            "OVER",
            "OVERLAPS",
            "OVERLAY",
            "OVERWRITE",
            "PARTITION",
            "PARTITIONED",
            "PARTITIONS",
            "PERCENTILE_CONT",
            "PERCENTILE_DISC",
            "PERCENTLIT",
            "PIVOT",
            "PLACING",
            "POSITION",
            "PRECEDING",
            "PRIMARY",
            "PRINCIPALS",
            "PROPERTIES",
            "PURGE",
            "QUARTER",
            "QUERY",
            "RANGE",
            "RECORDREADER",
            "RECORDWRITER",
            "RECOVER",
            "REDUCE",
            "REFERENCES",
            "REFRESH",
            "RENAME",
            "REPAIR",
            "REPEATABLE",
            "REPLACE",
            "RESET",
            "RESPECT",
            "RESTRICT",
            "REVOKE",
            "RIGHT",
            "RLIKE",
            "ROLE",
            "ROLES",
            "ROLLBACK",
            "ROLLUP",
            "ROW",
            "ROWS",
            "SECOND",
            "SCHEMA",
            "SCHEMAS",
            "SELECT",
            "SEMI",
            "SEPARATED",
            "SERDE",
            "SERDEPROPERTIES",
            "SESSION_USER",
            "SET",
            "SETMINUS",
            "SETS",
            "SHOW",
            "SKEWED",
            "SOME",
            "SORT",
            "SORTED",
            "START",
            "STATISTICS",
            "STORED",
            "STRATIFY",
            "STRUCT",
            "SUBSTR",
            "SUBSTRING",
            "SYNC",
            "SYSTEM_TIME",
            "SYSTEM_VERSION",
            "TABLE",
            "TABLES",
            "TABLESAMPLE",
            "TBLPROPERTIES",
            "TEMPORARY",
            "TERMINATED",
            "THEN",
            "TIME",
            "TIMESTAMP",
            "TIMESTAMPADD",
            "TIMESTAMPDIFF",
            "TO",
            "TOUCH",
            "TRAILING",
            "TRANSACTION",
            "TRANSACTIONS",
            "TRANSFORM",
            "TRIM",
            "TRUE",
            "TRUNCATE",
            "TRY_CAST",
            "TYPE",
            "UNARCHIVE",
            "UNBOUNDED",
            "UNCACHE",
            "UNION",
            "UNIQUE",
            "UNKNOWN",
            "UNLOCK",
            "UNSET",
            "UPDATE",
            "USE",
            "USER",
            "USING",
            "VALUES",
            "VERSION",
            "VIEW",
            "VIEWS",
            "WEEK",
            "WHEN",
            "WHERE",
            "WINDOW",
            "WITH",
            "WITHIN",
            "YEAR",
            "ZONE",
            "EQ",
            "NSEQ",
            "NEQ",
            "NEQJ",
            "LT",
            "LTE",
            "GT",
            "GTE",
            "PLUS",
            "MINUS",
            "ASTERISK",
            "SLASH",
            "PERCENT",
            "TILDE",
            "AMPERSAND",
            "PIPE",
            "CONCAT_PIPE",
            "HAT",
            "COLON",
            "ARROW",
            "HENT_START",
            "HENT_END",
            "STRING",
            "BIGINT_LITERAL",
            "SMALLINT_LITERAL",
            "TINYINT_LITERAL",
            "INTEGER_VALUE",
            "EXPONENT_VALUE",
            "DECIMAL_VALUE",
            "FLOAT_LITERAL",
            "DOUBLE_LITERAL",
            "BIGDECIMAL_LITERAL",
            "IDENTIFIER",
            "BACKQUOTED_IDENTIFIER",
            "SIMPLE_COMMENT",
            "BRACKETED_COMMENT",
            "WS",
            "UNRECOGNIZED"
    };

    public HiveCompletionContributor() {
        extend(
                CompletionType.BASIC,
                PlatformPatterns.psiElement(),
                new HiveKeyWordCompletion(KEY_WORDS, HiveFileType.INSTANCE.getIcon()));
    }

    public static boolean isNotKeyword(String s) {
        return !Arrays.asList(KEY_WORDS).contains(s);
    }
}
